<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="420" viewBox="0 0 900 420">
  <style>
    .box { fill: #ffffff; stroke: #111827; stroke-width:1.5; rx:8; }
    .title { font: 700 14px/1.2 'Segoe UI', Roboto, sans-serif; fill: #111827 }
    .label { font: 12px/1.2 'Segoe UI', Roboto, sans-serif; fill: #374151 }
    .arrow { stroke: #0ea5a4; stroke-width:2; fill: none; marker-end: url(#arrowhead);} 
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#0ea5a4" />
    </marker>
  </defs>

  <!-- Client -->
  <rect x="30" y="40" width="160" height="80" class="box"/>
  <text x="50" y="62" class="title">Browser / Client</text>
  <text x="50" y="82" class="label">Next.js (pages, components)</text>

  <!-- Frontend -->
  <rect x="230" y="30" width="200" height="100" class="box"/>
  <text x="250" y="52" class="title">Frontend</text>
  <text x="250" y="72" class="label">Next.js + Tailwind + Zustand</text>
  <text x="250" y="92" class="label">/register, /login, /dashboard, /product</text>

  <!-- Backend -->
  <rect x="480" y="20" width="240" height="120" class="box"/>
  <text x="500" y="48" class="title">Backend API</text>
  <text x="500" y="68" class="label">Express + TypeScript</text>
  <text x="500" y="88" class="label">Routes: /auth, /purchase, /dashboard</text>

  <!-- DB -->
  <rect x="370" y="200" width="220" height="120" class="box"/>
  <text x="390" y="226" class="title">MongoDB</text>
  <text x="390" y="246" class="label">Collections: users, referrals, purchases</text>

  <!-- Models small boxes -->
  <rect x="640" y="200" width="220" height="120" class="box"/>
  <text x="660" y="222" class="title">Models</text>
  <text x="660" y="242" class="label">User { email, referralCode, credits }</text>
  <text x="660" y="262" class="label">Referral { referrer, referred, credited }</text>
  <text x="660" y="282" class="label">Purchase { user, amount }</text>

  <!-- Arrows -->
  <path d="M190 80 L230 80" class="arrow" />
  <path d="M430 80 L480 80" class="arrow" />
  <path d="M600 140 L600 200" class="arrow" />
  <path d="M480 140 L460 200" class="arrow" />

  <!-- Flow labels -->
  <text x="280" y="60" class="label">HTTP requests (REST)</text>
  <text x="520" y="110" class="label">Business logic: create user, create referral, handle purchases</text>
  <text x="460" y="190" class="label">Reads / Writes</text>

  <!-- Example sequence note -->
  <g>
    <text x="40" y="350" class="title">Example: First-purchase credit flow</text>
    <text x="40" y="370" class="label">1) New user registers with ?ref=CODE → Backend creates User + Referral(pending)</text>
    <text x="40" y="388" class="label">2) Referred user makes first purchase → Backend creates Purchase, increments credits for referrer & referred, marks Referral.credited=true</text>
  </g>

</svg>
